(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2683:function(e,l,n){Promise.resolve().then(n.bind(n,5945)),Promise.resolve().then(n.bind(n,9167)),Promise.resolve().then(n.bind(n,9633))},9633:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return components_DataTable}});var r=n(7437),a=n(2265),s=n(3198),t=n(2424),i=n(6055),o=n(879),d=n(9050),c=n(5795),u=n(6857),h=n(6988),p=n(8489),x=n(666),m=n(5781),g=n(9279),f=n(2653),v=n(2038),j=n(3391),b=n(9963),y=n(740),C=n(6446),Z=n(5597),k=n(2481),w=n(9394),S=n(1797),P=n(6337),N=n(9812),I=n(7760),R=n(2834),E=n(8122),components_ManageColumnsModal=e=>{let{open:l,onClose:n}=e,i=(0,s.I0)(),c=(0,s.v9)(e=>e.table.columns),[u,h]=a.useState(""),[p,x]=a.useState("");return(0,r.jsxs)(w.Z,{open:l,onClose:n,maxWidth:"sm",fullWidth:!0,children:[(0,r.jsx)(S.Z,{children:"Manage Columns"}),(0,r.jsxs)(P.Z,{children:[(0,r.jsx)(E.Z5,{onDragEnd:e=>{if(!e.destination)return;let l=Array.from(c),[n]=l.splice(e.source.index,1);l.splice(e.destination.index,0,n),i((0,t.Bx)(l))},children:(0,r.jsx)(E.bK,{droppableId:"cols",children:e=>(0,r.jsxs)("div",{ref:e.innerRef,...e.droppableProps,style:{display:"flex",flexDirection:"column",gap:4},children:[c.map((e,l)=>(0,r.jsx)(E._l,{draggableId:e.key,index:l,children:l=>(0,r.jsx)("div",{ref:l.innerRef,...l.draggableProps,...l.dragHandleProps,style:{display:"flex",alignItems:"center",gap:4,background:"#f7f7f7",borderRadius:6,padding:"4px 8px",...l.draggableProps.style},children:(0,r.jsx)(N.Z,{control:(0,r.jsx)(I.Z,{checked:e.visible,onChange:()=>i((0,t.u$)(e.key))}),label:"".concat(e.label," (").concat(e.key,")")})})},e.key)),e.placeholder]})})}),(0,r.jsxs)("div",{style:{display:"flex",gap:8,marginTop:16,flexWrap:"wrap"},children:[(0,r.jsx)(o.Z,{value:u,onChange:e=>h(e.target.value),placeholder:"field key (e.g. department)",size:"small"}),(0,r.jsx)(o.Z,{value:p,onChange:e=>x(e.target.value),placeholder:"label (e.g. Department)",size:"small"}),(0,r.jsx)(d.Z,{onClick:()=>{if(!u.trim()||!p.trim())return;let e=[...c,{key:u,label:p,visible:!0}];i((0,t.Bx)(e)),h(""),x("")},variant:"outlined",children:"Add"})]})]}),(0,r.jsx)(R.Z,{children:(0,r.jsx)(d.Z,{onClick:n,children:"Close"})})]})},M=n(1812),_=n.n(M),D=n(8613);async function importCSV(e){return new Promise((l,n)=>{_().parse(e,{header:!0,skipEmptyLines:!0,complete:e=>{e.errors&&e.errors.length?n(e.errors):l(e.data)}})})}function exportCSV(e,l){let n=e.map(e=>{let n={};return l.forEach(l=>n[l.label]=e[l.key]),n}),r=_().unparse(n),a=new Blob([r],{type:"text/csv;charset=utf-8;"});(0,D.saveAs)(a,"export.csv")}var components_DataTable=()=>{let e=(0,s.I0)(),l=(0,s.v9)(e=>e.table.rows),n=(0,s.v9)(e=>e.table.columns),[w,S]=(0,a.useState)(""),[P,N]=(0,a.useState)(0),[I,R]=(0,a.useState)(!1),[E,M]=(0,a.useState)(null),[_,D]=(0,a.useState)(null),[A,V]=(0,a.useState)(null),[B,T]=(0,a.useState)({}),L=(0,a.useMemo)(()=>n.filter(e=>e.visible),[n]),z=(0,a.useMemo)(()=>{let e=l;if(w){let l=w.toLowerCase();e=e.filter(e=>L.some(n=>{var r;return String(null!==(r=e[n.key])&&void 0!==r?r:"").toLowerCase().includes(l)}))}return E&&_&&(e=[...e].sort((e,l)=>{let n=e[E],r=l[E];if(!isNaN(Number(n))&&!isNaN(Number(r)))return"asc"===_?Number(n)-Number(r):Number(r)-Number(n);let a=(null!=n?n:"").toString().toLowerCase(),s=(null!=r?r:"").toString().toLowerCase();return a<s?"asc"===_?-1:1:a>s?"asc"===_?1:-1:0})),e},[l,w,L,E,_]),handleDelete=l=>{confirm("Delete this row?")&&e((0,t.qK)(l))},handleImport=async l=>{var n;let r=null===(n=l.target.files)||void 0===n?void 0:n[0];if(r){try{let l=await importCSV(r);if(l.length){let n=l.map((e,l)=>({id:String(Date.now()+l),...e}));e((0,t.P5)(n))}else alert("No rows parsed or invalid CSV")}catch(e){alert("CSV parse error")}l.currentTarget.value=""}},handleSort=e=>{if(E!==e){M(e),D("asc");return}"asc"===_?D("desc"):"desc"===_?D(null):D("asc")},handleEdit=e=>{let n=l.find(l=>l.id===e);n&&(V(e),T(n))},handleCancel=()=>{V(null),T({})},handleSave=()=>{if(A){if(B.age&&isNaN(Number(B.age))){alert("Age must be a number");return}e((0,t.RQ)(B)),V(null),T({})}};return(0,r.jsxs)(i.Z,{sx:{p:2},children:[(0,r.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12,alignItems:"center"},children:[(0,r.jsx)(o.Z,{size:"small",placeholder:"Search...",value:w,onChange:e=>S(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(N(0),setTimeout(()=>S(""),1e3))},onBlur:()=>{""!==w.trim()&&setTimeout(()=>S(""),1e3)}}),(0,r.jsxs)(d.Z,{startIcon:(0,r.jsx)(Z.Z,{}),component:"label",children:["Import",(0,r.jsx)("input",{hidden:!0,type:"file",accept:"text/csv",onChange:handleImport})]}),(0,r.jsx)(d.Z,{onClick:()=>exportCSV(z,L),startIcon:(0,r.jsx)(k.Z,{}),children:"Export CSV"}),(0,r.jsx)(d.Z,{onClick:()=>R(!0),children:"Manage Columns"}),(0,r.jsx)(d.Z,{variant:"outlined",color:"success",onClick:()=>{alert("All changes saved!")},children:"Save All"}),(0,r.jsx)(d.Z,{variant:"outlined",color:"error",onClick:()=>{window.location.reload()},children:"Cancel All"})]}),(0,r.jsx)(c.Z,{sx:{overflowX:"auto"},children:(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(h.Z,{children:(0,r.jsxs)(p.Z,{children:[L.map(e=>(0,r.jsx)(x.Z,{children:(0,r.jsx)(m.Z,{active:E===e.key&&!!_,direction:null===_?"asc":_,onClick:()=>handleSort(e.key),children:e.label})},e.key)),(0,r.jsx)(x.Z,{children:"Actions"})]})}),(0,r.jsx)(g.Z,{children:z.slice(10*P,10*P+10).map(e=>(0,r.jsxs)(p.Z,{children:[L.map(l=>{var n,a;return(0,r.jsx)(x.Z,{children:A===e.id?(0,r.jsx)(o.Z,{size:"small",value:null!==(n=B[l.key])&&void 0!==n?n:"",onChange:e=>T({...B,[l.key]:e.target.value})}):String(null!==(a=e[l.key])&&void 0!==a?a:"")},l.key)}),(0,r.jsx)(x.Z,{children:A===e.id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{onClick:handleSave,color:"success",children:(0,r.jsx)(b.Z,{})}),(0,r.jsx)(f.Z,{onClick:handleCancel,color:"error",children:(0,r.jsx)(y.Z,{})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{onClick:()=>handleEdit(e.id),children:(0,r.jsx)(j.Z,{})}),(0,r.jsx)(f.Z,{onClick:()=>handleDelete(e.id),children:(0,r.jsx)(C.Z,{})})]})})]},e.id))})]})}),(0,r.jsx)(v.Z,{component:"div",count:z.length,page:P,onPageChange:(e,l)=>{let n=Math.max(0,Math.ceil(z.length/10)-1);l>=0&&l<=n&&N(l)},rowsPerPage:10,onRowsPerPageChange:()=>{},rowsPerPageOptions:[10],labelRowsPerPage:""}),(0,r.jsx)(components_ManageColumnsModal,{open:I,onClose:()=>R(!1)})]})}},2424:function(e,l,n){"use strict";n.d(l,{Bx:function(){return s},P5:function(){return d},RQ:function(){return c},qK:function(){return o},u$:function(){return t}});var r=n(663);let a=(0,r.oM)({name:"table",initialState:{columns:[{key:"name",label:"Name",visible:!0},{key:"email",label:"Email",visible:!0},{key:"age",label:"Age",visible:!0},{key:"role",label:"Role",visible:!0}],rows:[]},reducers:{setColumns:(e,l)=>{e.columns=l.payload},toggleColumn:(e,l)=>{let n=e.columns.find(e=>e.key===l.payload);n&&(n.visible=!n.visible)},setRows:(e,l)=>{e.rows=l.payload},deleteRow:(e,l)=>{e.rows=e.rows.filter(e=>e.id!==l.payload)},addRows:(e,l)=>{e.rows.push(...l.payload)},updateRow:(e,l)=>{let n=e.rows.findIndex(e=>e.id===l.payload.id);-1!==n&&(e.rows[n]={...e.rows[n],...l.payload})}}}),{setColumns:s,toggleColumn:t,setRows:i,deleteRow:o,addRows:d,updateRow:c}=a.actions;l.ZP=a.reducer}},function(e){e.O(0,[338,320,657,971,472,744],function(){return e(e.s=2683)}),_N_E=e.O()}]);